#####################
# Plugins
#####################

# Base
    set -g @plugin 'tmux-plugins/tpm'
    set -g @plugin 'tmux-plugins/tmux-sensible'

# Vim-integration
    set -g @plugin 'christoomey/vim-tmux-navigator'

# Theme
    set -g @plugin 'catppuccin/tmux'
    set -g @catppuccin_flavour 'mocha' 

# Undercurls 
    set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'  # undercurl support
    set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'  # underscore colours - needs tmux-3.0

#####################
# Settings
#####################

# remap prefix to Control + a
    set -g prefix C-a

# bind 'C-a C-a' to type 'C-a'
    bind C-a send-prefix
    unbind C-b

# Enable TrueColor support
    set-option -g default-terminal "xterm-kitty"

# Setup tmux with shell and environment
    set -g default-shell $SHELL

# Start windows and panes at 1, not 0
    set -g base-index 1
    setw -g pane-base-index 1

# Set low ESC delay
    set -g escape-time 10

# Renumber windows on delete
    set-option -g renumber-windows on

# Use vim keybindings in copy mode
    setw -g mode-keys vi

# Setup 'v' to begin selection as in Vim
    bind-key -T copy-mode-vi v send-keys -X begin-selection
    bind-key -T copy-mode-vi y send-keys -X copy-pipe "reattach-to-user-namespace pbcopy"

# Update default binding of `Enter` to also use copy-pipe
    unbind -T copy-mode-vi Enter
    bind-key -T copy-mode-vi Enter send-keys -X copy-pipe "reattach-to-user-namespace pbcopy"

# UI
    set -g @colors-solarized 'dark'

# Pane resize in all four directions using vi bindings.
# Can use these raw but I map them to shift-ctrl-<h,j,k,l> in iTerm.
    bind -r h resize-pane -L 5
    bind -r j resize-pane -D 5
    bind -r k resize-pane -U 5
    bind -r l resize-pane -R 5

# Remap pane splits to keep current path
    bind v split-window -h -c '#{pane_current_path}'
    bind s split-window -v -c '#{pane_current_path}'
    bind c new-window -c '#{pane_current_path}'

#####################
# Tmux Plugin Manager
#####################

# Note: Plugins defined at the top of the file

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
